--------------------------------------------------------------------------
title: vim常用命令  version:0.0.3 date:2018-09-14 author:lx_7
--------------------------------------------------------------------------

推荐：http://harttle.com/2015/11/07/vim-cursor.html

:set bomb?	#查询文件是否有 bom
:set nobomb	#设置文件清除 bom
:set fileencoding?	#查询文件编码
:set fileencoding=utf-8	#设置文件编码utf-8
:set shell?		#查询使用的shell

批量处理:

:args \d\a\*.txt 		#批量标记文件,把所有相关文件放进参数列表
:arga xx.txt			#在args文件列表后面加入新文件参数
:argdo set nobomb | update 	#批量清除并更新文件 update在文件有变更时保存
:windo				#所有视窗内执行其参数所规定的命令
:argdo call append(0, "<?php") | update	#批量第0行后添加字符串有变更时保存

:[range]global/{pattern}/{command}	#在 [range] 指定的文本范围内（缺省为整个文件）查找 {pattern}，然后对匹配到的行执行命令 {command}，
					 如果希望对没匹配上的行执行命令，则使用 global!  或 vglobal 命令。首先扫描 [range] 指定范围内的所有行，
					 给匹配 {pattern} 的行打上标记；然后依次对打有标记的行执行 {command} 命令，如果被标记的行在对之前匹配行
					 的命令操作中被删除、移动或合并，则其标记自动消失，而不对该行执行 {command} 命令。

特殊字符:

	(Insert Mode)

	(^K)1、通过两个字符来输入一个特殊字符（digraph）。	<Ctrl-K>Rg
 
     	(^V)2、直接通过编码值（ASCII或Unicode）输入。	<Ctrl-V>065（Windows下<Ctrl-Q>）
	
		十进制值ASCII：^Vnnn (000 <= nnn <= 255)
 

      		八进制值：^VOnnn 或 ^Vonnn (000 <= nnn <= 377)
 

      		十六进制值：^VXnn or ^Vxnn (00 <= nn <= FF)
 

      		十六进制BMP Unicode：^Vunnnn (0000 <= nnnn <= FFFF)
 

      		十六进制任何Unicode：^VUnnnnnnnn (00000000 <= nnnnnnnn <= 7FFFFFFF)

:digraphs				#二合字符的参考（特殊字符输入）
:dig[raphs] {char1}{char2} {number} ...	#定义新的二合字符
ga					#Normal Mode下，此特殊字符的明细

打开文件：

	未启动vim

		vim file1 file2 file3...

		vim -p file1	#以多标签形式打开文件

	启动vim
		:e file1	#打开远程文件，比如ftp或者share folder

		:open file1	#在当前标签页中打开指定的文件

		:tatbnew file1	#在新标签页中编辑新的文件

		:tabe file1  	#在新标签页中打开指定的文件
		
		:sp		#水平打开新窗口(水平分割) split
		
		:vsp		#垂直打开新窗口(垂直分割) vsplit
		
		:e# 		#回到刚才编辑的文件
		
		:file filename	#给当前文件重命名（文件重命名后处于未保存状态）
		
		:n 		#跳至下一个文件，也可以直接指定要跳的文件
		
		:ls 或 :buffers	#列出缓存区列表
	
		:bn		#切换到缓存区下一个文件

		:bp		#切换到缓存区上一个文件
	
		:bd 2 4		#删除2和4号缓存区,这个缓冲区实际上成了 "列表外" 缓冲区，它不再出现在 ":buffers" 命令所报告的列表中
	
		:bw 2		#彻底清除一个缓冲区 buffer wipe

标记：

	<Esc> 		#按退出键
	<CR> 		#按回车键，也写作<Enter>
	<Ctrl> 		#按控制键
	<Tab> 		#按制表键
	<Shift> 	#按切换键
	<S-Tab> 	#同时按<Shift> 和<Tab>
	<Up> 		#按上光标键
	<Down> 		#按下光标键

执行、重复、回退:

	目的 				操作 			重复 	回退

	做出一个修改 			{edit} 			. 	u
	在行内查找下一指定字符 		f{char}/t{char} 	; 	,
	在行内查找上一指定字符		F{char}/T{char} 	; 	,
	在文档中查找下一处匹配项	/pattern<CR> 		n 	N
	在文档中查找上一处匹配项	?pattern<CR> 		n 	N
	执行替换 			:s/target/replacement 	& 	u
	执行一系列修改			qx{changes}q 		@x 	u

命令格式:  操作+范围+对象

    对象

	w	#word单词
	s	#sentence句子
	p	#paragraph段落
	' " ) ] } >	#等成对的
	t	#Tag标签

    范围

	i	#在里面
	a	#所有, 包括成对的引号等

    操作

	d	#删除
	y	#复制
	v	#选中
	c	#替换

	/<html>/+1,/<\/html>/-1

Insert Mode：

	(建议先删除整个单词，然后再重新输入)

	<C-h> 		#删除前一个字符（同退格键）
	<C-w> 		#删除前一个单词
	<C-u> 		#删至行首

	<C-r>{register}	#插入的寄存器内容
	<C-r>=6*35<CR>	#表达式寄存器，执行计算
	<C-o> 		#切换到插入-普通模式(执行一个普通模式命令，执行完后，马上就又返回到插入模式)

1.Normal mode：
 
   1：
	hjkl	#(强例推荐使用其移动光标，但不必需) →你也可以使用光标键 (←↓↑→). 注: j 就像下箭头。

	:q! <ENTER>	#此命令使编辑器退出并放弃你作的作用改动。(即不保存对文本的编辑）
	
	x	#按下x键以删除光标所在的字符
	
	i	#按下 i键 进入Insert 模式 以光标前 以插入文本，按 ESC 回到 Normal 模式.
	
	I	#在当前行首插入
	
	a	#按下 A键 以光标后 追加文本
	
	A	#在当前行尾插入
	
	:wq	#保存文件并退出
	
	Ctrl + f	#屏幕『向下』移动一页
	
	Ctrl + b	#屏幕『向上』移动一页
	
	Ctrl + d	#屏幕『向下』移动半页
	
	Ctrl + u	#屏幕『向上』移动半页

    :help usr_03.txt    #查看帮助文件
    
  2：

	dw	#以删除一个单词
	
	d$	#以删除光标到行尾间处的字符


	d	-是操作码
	motlion -是操作码要操作的对象（译者：更确切地说应是范围吧?）(罗列在下方）

  	关于对象的小清单：

	 	w 	#到下一个词首，除开所在的第一个字符。W到下个字符串首
        
        b   #到上一个词首

	 	e 	#到下一个单词尾，包括所在单词的最后一个字符。

        ge  #到上一个词尾
        
	 	$ 	#到行尾，包括了最后一个字符。

         	0 	#到行首，包含空格。

         	^ 	#到行首，不含空格。
	
		+	#光标移动到非空格符的下一列

		-	#光标移动到非空格符的上一列
	
		n<space>	#那个 n 表示『数字』，按下数字后再按空格键，光标会向右移动这一行的 n 个字符。例如 20<space> 则光标会向后面移动 20 个字符距离。
		
		n<Enter>	#n 为数字。光标向下移动 n 行(常用)

	 	H	#光标移动到这个屏幕的最上方那一行的第一个字符,H你就把它记成是header的缩写，这样就好记了

	 	M	#光标移动到这个屏幕的中那一行的第一个字符,M你就把它记成middle的缩写

		L	#光标移动到这个屏幕的最下方那一行的第一个字符,L你就把它记成last的缩写

	 	G	#到文本最后一行首

	 	nG	#n 为数字。移动到这个档案的第 n 行

	 	gg	#到文本首行。

 	所以de会删除光标处到单词尾下的字符。
	
	在对象前键入重复的次数
	
	键入 2w 以使光标向前移动两个单词。

	键入 d2w 以删除2个大写 单词
	
	键入  2dd 以删除后两行

	
	dd	#以删除一整行

	u	#以恢复最后的命令
	
	U	#是修复一整行,以回到行的原始状态
	
	CTRL+R	#重做（按住CTRL同时敲击R）,以撤消恢复命令（与u命令相反）
	
	.	#重复上一次命令

  3：
	
	p	#以在光标处粘贴先前删除的文本

	r	#以替换光标处的一个字符
	
	R	#以替换光标处的多个字符

	ce	#是删除单词并定位到插入模式（译者：其实后面的e就是对象，而前面的 c是操作码）

  4：
	
	CTRL-G	#以显示你在文件中的位置和状态,按住CTRL键，并键入 g. 我们称之为CTRL-G,指出文件名和当前文件位置
	
	G	#以移动到文件行尾
	
	gg	#以移动到文件首。
	
	/	#按 /  并接一个要搜索的短语
		想再次搜索相同的短语，简单的键入 n
		想再次搜索相同的短语并以相反的方向，键入 N
		要反向搜索一个短语，使用?替换/
		要返回之前的位置，键入 CTRL-O（按住 CTRL时，按下字母o).重复几次回到更早的那刻。CTRL-I是向前移动。
		注：	当搜索到达文件尾时，它会从文件头开始搜索，除非’wrapscan'选项被设置了。

	%	#将光标定位到任一的(,[,{.键入 % 以找到所匹配的),],or }
	
	:s/old/new/g	#在当前行,所有的’new'替换‘old’
			键入  :s/thee/the <ENTER>.注意此命令仅会更改本行的第一例"thee".
			键入 :s/three/the/g. 加入的 g 标志 意味着 会替换本行所有的“thee".
			type   :#,#s/old/new/g    其中，#,#是要更改的行号的范围
    			Type   :%s/old/new/g      更改全文件中的所有事件。
			Type   :%s/old/new/ge      更改全文件中的所有事件,找不到不显示提示信息。
     			Type   :%s/old/new/gc      更改全文件中的所有事件,并给出替换与否的提示。

  5：
	:!	#按  :!  并加上要执行的外部命令,允许你执行一个任何外部的shell命令
	
	w FILENAME	#要保存对文本作的改动
	
	v	#进入选择模式, 按 v 并移动 光标到 以下的第5项。 注意这些文本会高亮。按  ：字符。在屏幕底会显示  :'<,'> will appear.按 w TEST ,其中 TEST 是一个不存在 的文件。

	r FILENAME	#要插入一个文件的内容键入：r FILENAME

  6.

	o	#键入 o 以在光标下打开一行，并置于插入模式(Insert mode)
	
	O	#键入 O 以在光标上打开一行，并置于插入模式(Insert mode)
	
	注：  a,i 和A  都会进入插入模式，仅有的不同是字符在哪里插入
	
	y	#操作码来复制文本

	p	#粘贴此文本
	
	:set ic	#设置搜索和替换时忽略大小写

	:set noic	#禁止忽略大小写
	
	:nohlsearch	#要删除高亮匹配
	
	/ignore\c <enter>	#只是想在某次搜索命令时忽略大小写

  7.
	 
	:help <enter>	#使用在线帮助系统,键入 ：help 或 <F1> 或<help>以打开帮助窗口

	<TAB>	#使命令行补齐
	
	CTRL-D	#会显示可补齐命令的清单
	
	CTRL-W	#以跳转到另一窗口

  8.
	
	:reg	#查看各个粘贴板里的内容,vim有12个粘贴板，分别是0、1、2、...、9、a、“、＋；
	
	"Np	#其中N为粘贴板号
	
	“号粘贴板（临时粘贴板）比较特殊，直接按y就复制到这个粘贴板中了，直接按p就粘贴这个粘贴板中的内容；
	
	+号粘贴板 是系统粘贴板，用"+y将内容复制到该粘贴板后可以使用Ctrl＋V将其粘贴到其他文档（如firefox、gedit）中，同理，要把在其他地方用Ctrl＋C或右键复制的内容复制到vim中，需要在正常模式下按"+p	

	复制 

	方法一： 先ma标记当前位置为a，移动到新的位置，再y`a或者y'a复制从标记位置a到当前位置的内容。`和'的区别：`以字符为单位，'以行为单位。这个方法应该是所有vi都适用的。（如果不对请指正。）

	方法二： 按v或V或Ctrl+V进入visual模式，移动光标选择一段内容，按y(若要使用系统黏贴板，按"+y)。三者的区别： v以字符为单位，V以行为单位，Ctrl+V是块选择。这个方法只在VIM下适用。
	

	粘贴 

		p或P。区别：前者粘贴到光标后面，后者粘贴到光标前面。

	tips:
		ci'、ci"、ci(、ci[、ci{、ci< 		#分别更改这些配对标点符号中的文本内容

		di'、di"、di(或dib、di[、di{或diB、di< 	#分别删除这些配对标点符号中的文本内容


		yi'、yi"、yi(、yi[、yi{、yi< 		#分别复制这些配对标点符号中的文本内容
		vi'、vi"、vi(、vi[、vi{、vi< 		#分别选中这些配对标点符号中的文本内容

	
	行的拼接：

		在选择模式选中要拼接的行：ggvG
			输入：  :'<,'>j<enter>
			注：普通的j用于拼接单行。

	列操作：

		选中全文的第一列
			按gg跳至开头
			按CTRL――V进入列选择状态:visula block
			按G到末尾
		将每行的第一列变为大写
			按U将选中内容变大写
			按u将选中内容变小写
			按~将大小翻转。

	列操作：在第行前加一个星号和空格：
			选中第一列
			按I进入插入状态
			输入:*<space><ESC>
			选中前两列后按x，可时行列删除
	
	宏的录制：将所有偶数行后加入OK！
			按gg进入第一行
			按qm进入宏录制
				按j$进入第二行尾
				按aok!以输入ok!
				按<esc>返回
				按j到下一行
				按q结束宏录制

	宏的播放：（接上面的步骤）

		单次播放：
			按下@m,执行m寄存器中的宏
			可以发现第4行中的尾已经加入了ok!
		多次播放：
			按下100@m，这里重复播放100次宏。
	
	在多个文件中进行替换:

		一般可以用sed或者vim来做。比如要对当前目录下的*.c文件进行替换：
			方法一：
				for i in *.c; do
 					sed -i -e 's/oldvalue/newvalue/g' $i
				done


			方法二：
				vim *.c
				:argdo %s/oldvalue/newvalue/ge | update

	修改编辑宏:

	:put a		#输出a 寄存器的宏
	"ay		#保存到a寄存器	
	:set nomore	#列表消息会继续进行直到结束为止

 9.移动

	字符（h、l）→ 单词 (w、W、b、B、e) → 行 (j、k、0、^、$、:n) → 句子（(、)）→ 段落（{、}）→ 屏 (H、M、L) → 页（Ctrl-f、Ctrl-b、Ctrl-u、Ctrl-d) → 文件（G、gg、:0、:$）。

	%（跳转到与之匹配的括号处），`.（跳转到最近修改过的位置并定位编辑点），'.（跳转到最近修改过的位置但不定位编辑点）。
 
	>>  #单行缩进
    
   	<<  #单行回缩
    
    	:20,100>    #第20行至第100行缩进
    
	n|	#光标移动到第 n 列

    	%   #移动到匹配的位置
    
    	fc  #光标移动到右边的第一个’c’字符上, F是反向查找, ";"命令重复前一次输入的f, t, F, T命令，而","命令会反方向重复前一次输入的f, t, F, T命令
    
    	tc  #光标移动到右边的第一个’c’字符前面, T是反向查找
    
    	zt  #根据光标所在的位置滚屏，把光标所在行移动窗口的顶端
    
    	zz  #根据光标所在的位置滚屏，把光标所在行移动窗口的中间
    
    	zb  #根据光标所在的位置滚屏，把光标所在行移动窗口的底部
    
    	:jumps  #查看跳转表
    
    	(   #移到句子的开头

    	)   #移到句子的结尾

    	{   #移到段落的开头

    	}   #移到下一个段落的开头

    	[[  #回到段落的开头处

    	]]  #向前移到下一个段落的开头处
    
    	m(a-z)  #用一个字母来标记当前位置，如用mz表示标记z

    	'(a-z)  #将光标移动到指定的标记，如用'z表示移动到z
    
    	''  #此命令相当有用, (此处时两个单引号不是双引号)它移动光标到上一个标记处, 比如用 gd, * 等查找到某个单词后, 再输入此命令则回到上次停留的位置

    	'.  #此命令相当好使, 它移动光标到上一次的修改行

    	`.  #此命令相当强大, 它移动光标到上一次的修改点
    
    	CTRL-O   #光标返回到以前的位置。相当于光标移动的“撤销”

    	CTRL-I   #光标返回到后来的位置。相当于光标移动的“恢复”
    
 10.查找和替换
 
    	/   #即可进入查找模式，查找支持正则表达式，输入要查找的字符串并按下回车。 Vim会跳转到第一个匹配。按下n查找下一个，按下N查找上一个。
    
   	/foo\c   #\c 表示大小写不敏感查找，\C表示大小写敏感查找，将会查找所有的"foo","FOO","Foo"等字符串
   
   	*    #即可查找光标所在单词（word）， 要求每次出现的前后为空白字符或标点符号。例如当前为foo， 可以匹配foo bar中的foo，但不可匹配foobar中的foo。 
    
   	g*   #即可查找光标所在单词的字符序列，每次出现前后字符无要求。 即foo bar和foobar中的foo均可被匹配到。
   
   	:s   #（substitute）命令用来查找和替换字符串。语法如下：
   
            :{作用范围}s/{目标}/{替换}/{替换标志}

	正规表达式	#在正规表达式中使用 \( 和 \) 符号括起正规表达式，即可在后面使用\1、\2等变量来访问 \( 和 \) 中的内容。

			这种形式实际上是将\(与\)中的模式保存到了特殊的空间(称之为"保留缓冲区").这种方法可以保存任意一行中的9个模式.
			
			:set magic
		
			magic (\m)		#除了 $ . * ^ 之外其他元字符都要加反斜杠。
	
			nomagic (\M)		#除了 $ ^ 之外其他元字符都要加反斜杠
	
			very magic(\v)		#任何元字符都不用加反斜杠
	
			very nomagic(\V)	#任何元字符都必须加反斜杠

			/\m.* 			#查找任意字符串 
		
			/\M.* 			#查找字符串


		
			vim 		Perl		意义

			\{-n,m}		{n,m}?		n个到m个(忽略优先,非贪婪模式)
			\{-}		*?		0个或多个(忽略优先)
			\{-1,}		+?		1个或多个(忽略优先)
			\{-,1}		??		0个或1个(忽略优先)

			\@=		(?=		顺序环视
			\@!		(?!		顺序否定环视
			\@<=		(?<=		逆序环视
			\@<!		(?<!		逆序否定环视
			\@>		(?>		固化分组
			\%(word\)	(?:		非捕获型括号(此分组不捕获，可以理解为不算在分组信息中)

			vim中的环视和固化分组的模式的位置与perl不同:

			# Perl的写法 /(?<=foo)bar/ 
			# vim的写法 /\(foo\)\@<=barvim
            
        例如:
        
            作用范围:
            
                %s/foo/bar/g    #会在全局范围(%)查找foo并替换为bar，所有出现都会被替换（g）。
            
                :s/foo/bar/g    #当前行

                :%s/foo/bar/g   #全文
                
                :'<,'>s/foo/bar/g   #选区，在Visual模式下选择区域后输入:，Vim即可自动补全为 :'<,'>。
                
                :5,12s/foo/bar/g    #2-11行
                
                :.,+2s/foo/bar/g    #当前行.与接下来两行+2
                
            替换标志:
            
                :%s/foo/bar     #空替换标志，表示只替换从光标位置开始，目标的第一次出现
            
                :%s/foo/bar/i   #i表示大小写不敏感查找，I表示大小写敏感，#等效于模式中的\c（不敏感）或\C（敏感）:%s/foo\c/bar

                :%s/foo/bar/gc  #c表示需要确认，例如全局查找"foo"替换为"bar"并且需要确认：回车后Vim会将光标移动到每一次"foo"出现的位置，并提示
                                replace with bar (y/n/a/q/l/^E/^Y)?
                                按下y表示替换，n表示不替换，a表示替换所有，q表示退出查找模式， l表示替换当前位置并退出。^E与^Y是光标移动快捷键

	批量文件查找:

	:vimgrep /{pattern}/[g][j] {file} ...	#查找的结果可以用:copen命令打开quickfix列表查看,  没有参数g的话,则行只查找一次关键字.反之会查找所有的关键字,
						 没有参数j的话,查找后,VIM会跳转至第一个关键字所在的文件.反之,只更新结果列表(quickfix).
	
	:vimgrep word * 	#在当前目录查找word

	:vimgrep word **	#递归查找word在所有下级目录里面

	:copen    		#打开quickfix

	:cclose   		#关闭quickfix

	:cc       		#转到当前查找到的位置

	:cn       		#转到下一个位置 
	
	:cp       		#转到前一个位置

 11.标签页

	:tabe <文件名>  	#在新标签页中打开指定的文件 tab edit

	:tabnew <文件名>  	#在新标签页中编辑新的文件

	:tabs  			#显示已打开标签页的列表，并用“>”标识出当前页面，用“+”标识出已更改的页面 tab show

	:tab split		#在新标签页中，打开当前缓冲区中的文件

	:tabc  			#关闭当前标签页

	:tabo  			#关闭所有的标签页 tab other closed

	:tabn或gt  		#移动到下一个标签页 tab next

	:tabp或gT  		#移动到上一个标签页 tab previous

	:tabfirst或:tabr  	#移动到第一个标签页

	:tablast  		#移动到最后一个标签页

	:tabdo <命令>  		#同时在多个标签页中执行命令

	:help tab-page-intro	#可以获得关于标签页使用的更多信息

 12.窗口

	横向切割窗口：

		:new+窗口名(保存后就是文件名)
		
		:split+窗口名 或 :sp+窗口名
	
	纵向切割窗口名：
		
		:vsplit+窗口名 或 ：vsp+窗口名
	
	关闭窗口：
		
		q  或 close   #关闭当前窗口

     		only          #保留当前窗口，关闭其它所有窗口

    		qall(qa)      #退出所有窗口

    		wall          #保存所有窗口

		ctrl+w+w	#窗口切换

	文件浏览:

		:Ex 		#开启目录浏览器，可以浏览当前目录下的所有文件，并可以选择

		:Sex 		#水平分割当前窗口，并在一个窗口中开启目录浏览器

		:ls 		#显示当前buffer情况

	vi与shell切换:

		:shell 		#可以在不关闭vi的情况下切换到shell命令行
		
		:exit 		#从shell回到vi

 13.折叠
	
	要使每次打开vim时折叠都生效，则在.vimrc文件中添加设置，如添加：set fdm=syntax

	:set foldmethod=indent 	#设置foldmethod(折叠方式)

		manual           #默认折叠方法，手工定义折叠

		indent           #（常用）缩进折叠方法，更多的缩进表示更高级别的折叠

		expr             #用表达式来定义折叠

		syntax           #语法高亮折叠，用语法高亮来定义折叠

		diff             #对没有更改的文本进行折叠

		marker           #（常用）标记折叠方法，对文中的标志折叠

	注意，每一种折叠方式不兼容，如不能即用expr又用marker方式。

	:h Folding 	#查看折叠的帮助文档(在帮助文档中查询Folding)

	zo		#open打开当前折叠
	
	zO  		#打开光标下的折叠，以及嵌套的折叠

	zc		#close打开当前折叠
	
	zC  		#关闭光标下的折叠，以及嵌套的折叠
	
	za 		#打开/关闭当前折叠
	
	zA  		#和za类似，不过对当前折叠和其嵌套折叠都有效

	
	zr		#reduce(减少)打开所有折叠
	
	zR		#打开所有折叠及其嵌套的折叠

	zm		#more关闭所有折叠

	zM		#关闭所有折叠及其嵌套的折叠	


	zd		#删处当前折叠,仅当 ‘foldmethod’ 设为 “manual” 或 “marker” 时有效。
	
	zD  		#删除光标下的折叠，以及嵌套的折叠。
	
	zE  		#删除窗口内的所有折叠

	zf  		#创建折叠，可以选中代码后进行折叠。
   
	zF  		#在当前行创建折叠。当一开始就计划要折叠所写代码的时候，可以用该命令创建一对折叠符号，然后再往里面填写内容。  

	:5,10fo  	#在vim中运行该命令会在折叠 5-10 行中的代码，可以用其它数字代替之。 
	

	[z		#到当前打开的折叠的开始处
	
	]z		#到当前打开的折叠的末尾处

	zj		#移动至下一个折叠
	
	zk		#移动至上一个折叠


	zn		#禁用折叠

	zN		#启用折叠

	zi		#启用/禁用折叠	
	